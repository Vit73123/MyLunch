# My Lunch

__"Лучшее меню ресторана"__  
Spring Boot REST API приложение c авторизацией и правами доступа на основе ролей


## Стэк технологий

* Spring-Boot 3.2.1
* Spring Data JPA
* REST API (без frontend)
* Swagger
* Lombok
* Hebernate
* Jackson
* Тестовая база данных в памяти H2
* Caffeine Cache
* Spring Security
* JUnit 5
* Maven
* JDK 21


## Документация REST API


[Swagger REST API](http://localhost:8080/swagger-ui/index.html)


## Техническое задание


Разработать бэкенд для приложения, которое предоставляет пользователям систему выбора лучшего на его взгляд ресторана по его меню, где он хотел бы пообедать сегодня и мог бы за этот ресторан проголосовать.

__Требования:__

* два вида пользователей: администратор (admin), обычный пользователь (user)
* администратор может вводить ресторан и меню ресторана на определённый день (обычно 2-5 пунктов меню, по каждому пункту достаточно только информации о наименовании блюда и его цене)
* меню изменяется каждый день (администратор делает изменения)
* пользователь может оставить свой голос за тот ресторан, в котором он хотел бы сегодня пообедать
* для каждого пользователя допускается только один голос на сегодня
* если пользователь повторно голосует в тот же день:  
    если голосование прошло до 11:00, предполагается, что пользователь изменил своё решение, и голос меняется  
    если голосование прошло после 11:00, предполагается, что это слишком поздно, и свой голос изменить нельзя
* пользователь может проголосовать в первый раз в любое время в течение текущего дня

Каждый ресторан каждый день предоставляет новое меню.


## Установка и запуск приложения


* скачать приложение с [репозитория GitHub](https://github.com/Vit73123/MyLunch.git):  

    `git clone https://github.com/Vit73123/MyLunch.git`  

* перейти в корневую директорию проекта:  

    `cd .\MyLunch`  

* запустить проект:  

    `mvn spring-boot:run`

* учётные записи для авторизации (логин / пароль):  

    ```
    user@yandex.ru / password
    admin@gmail.com / admin
    guest@gmail.com / guest
    ```
* тестовые данные находятся в sql-скрипте популирования базы данных:  

    `resources/data.sql`

* для работы с api приложения из браузера введите адрес (endpoint) :

    [http://localhost:8080/api/profile](http://localhost:8080/api/profile)  

    По данному адресу будет предоставлен ваш профиль.


## Функционал


В приложении осуществляется работа со следующие базовыми объектами:

* Рестораны
* Блюда
* Меню
* Голоса за рестораны

Все запросы принимают данные об оъектах в формате _application /_ JSON.
Перечень всех доступных запросов и параметров приведён в [документации Swagger](http://localhost:8080/swagger-ui/index.html).

При всех операциях с ресурсами выполняется проверка на их принадлежность и соответствие ресурсам более высокого уровня и другим критериям, а также на констистентность данных в объекте (объект, переданный в запросе для его создания, является новым объектом, id объекта в запросе соответствует id его ресурса), правильность данных в объекте. При несоответствии данных обработчик ошибок возвращает в ответе статус, соответствующий виду ошибки.


Для работы с функционалом __администратора__, требуется авторизация с учётной записью пользователя, имеющего права администратора.  
Тестовая учётная запись пользователя с ролью администратора (логин / пароль):  

```
admin@gmail.com / admin
```

Для работы с функционалом __пользователя__, требуется авторизация с учётной записью пользователя, имеющего права пользователя.  
Тестовые учётные записи пользователей с ролям пользователя (логин / пароль):  

```
user@yandex.ru / password
guest@gmail.com / guest
```


### Рестораны


__Пользователи__ с объектами __Ресторан__ могут выполнять следующие действия:

* получить список только тех ресторанов, у которых есть меню на сегодня, и их меню.  

__Администраторы__ с объектами __Ресторан__ могут выполнять следующие действия:

* получить список всех ресторанов, имеющихся в базе данных;
* получить список всех ресторанов, у которых есть меню на сегодня, с/без меню;
* получить список всех ресторанов, у которых есть меню на указанную дату, с/без меню;
* получить ресторан по его id;
* получить ресторан по его email;
* удалить ресторан по его id


### Блюда


__Пользователи__ с объектами __Блюдо__ никаких действий выполнять не могут.

__Администраторы__ с объектами __Блюдо__ могут выполнять следующие действия:

* получить список блюд отдельного ресторана;
* получить отдельное блюдо данного ресторана;
* создать новое блюдо данного ресторана;
* изменить имеющееся в базе данных блюдо данного ресторана;
* удалить имеющееся в базе данных блюдо данного ресторана;


### Меню


__Пользователи__ с объектами __Меню__ могут выполнять следующие действия:

* 

__Администраторы__ с объектами __Меню__ могут выполнять следующие действия:

* 


### Голоса за рестораны


Все действия с объектами __Голос за ресторан__ доступны как __Администраторам__, так и __Пользователям__:

* получить историю своего голосования за все дни;
* получить свой голос за ресторан на сегодня;
* проголосовать текущей датой - создать свой голос за данный ресторан на сегодня;
* изменить свой голос на другой ресторан на сегодня, с учётом требований (только до 11:00);

После голосования пользователь удалить свой голос не может.  
Каждый пользователь (__Администратор__ или __Пользователь__) имеют доступ только к своему ресурсу Голосов.


## Функционал профилей пользователей


В приложении осуществляется работа с профилями пользователей через базовый объект:

* Пользователь

__Пользователи__ имеют доступ только к своему профилю и могут выполнять следующие действия:

* зарегистрироваться и создать свой профиль при первом входе в систему;
* изменить данные в своём профиле;
* удалить свой профиль.

__Администраторы__ с имеют доступ ко всем профилям пользователей и могут выполнять следующие действия:

* получить список всех пользователей;
* получить пользователя по его email;
* создать нового пользователя;
* изменить данные в профиле пользователя;
* удалить профиль пользователя;
* активировать/деактивировать пользователя.
